This is modified by Old-developer
Add some code by new devloper
